{{- /* Device-specific color overrides */ -}}
{{- $device_type := "desktop" -}}
{{- if hasKey . "device_type" -}}
  {{- $device_type = .device_type -}}
{{- end -}}
{{- $accent := .theme.colors.t5 -}}
{{- $accent_name := "green" -}}
{{- if eq $device_type "server" -}}
  {{- $accent = .theme.tokens.palette.cyan.normal -}}
  {{- $accent_name = "cyan" -}}
{{- end -}}

format = """
${custom.ssh_indicator}\
[ ${custom.live-clock-icon} $time ](fg:{{ .theme.colors.t1 }} bg:{{ $accent }})[](fg:{{ $accent }} bg:{{ .theme.colors.t2 }})\
[ $directory ](bg:{{ .theme.colors.t2 }})[](fg:{{ .theme.colors.t2 }} bg:{{ .theme.colors.t1 }})\
[ ($git_branch ${custom.git_status_dirty}$git_status )](fg:{{ $accent }} bg:{{ .theme.colors.t1 }})[](fg:{{ .theme.colors.t1 }} bg:none)\
$fill\
$package\
$docker$aws$kubernetes\
$nodejs$rust$golang$python$php$buf$c$cmake$elixir$java$kotlin$lua$ruby$zig\
$line_break[ $battery $character  ](fg:{{ $accent }} bg:{{ .theme.colors.t2 }})[ ](fg:{{ .theme.colors.t2 }} bg:none)\
"""

right_format = """
$status( $cmd_duration)\
"""

command_timeout = 2000

# Colors

palette = "starlach"

[palettes.starlach]
black = "{{ .theme.tokens.palette.black.normal }}"
red = "{{ .theme.tokens.palette.red.normal }}"
green = "{{ .theme.tokens.palette.green.normal }}"
yellow = "{{ .theme.tokens.palette.yellow.normal }}"
blue = "{{ .theme.tokens.palette.blue.normal }}"
purple = "{{ .theme.tokens.palette.magenta.normal }}"
cyan = "{{ .theme.tokens.palette.cyan.normal }}"
white = "{{ .theme.tokens.palette.white.normal }}"
bright-black = "{{ .theme.tokens.palette.black.bright }}"
bright-red = "{{ .theme.tokens.palette.red.bright }}"
bright-green = "{{ .theme.tokens.palette.green.bright }}"
bright-yellow = "{{ .theme.tokens.palette.yellow.bright }}"
bright-blue = "{{ .theme.tokens.palette.blue.bright }}"
bright-purple = "{{ .theme.tokens.palette.magenta.bright }}"
bright-cyan = "{{ .theme.tokens.palette.cyan.bright }}"
bright-white = "{{ .theme.tokens.palette.white.bright }}"


# Prompt

[character]
format = "$symbol"
success_symbol = "[󰚩 ](bg:prev_bg fg:{{ $accent_name }})"
error_symbol = "[󱚝 ](bg:prev_bg fg:red)"

[line_break]
disabled = false

[fill]
symbol = " "

# SSH Indicator

[custom.ssh_indicator]
when = '[ -n "$SSH_TTY" ]'
symbol = "󰣀"
format = "[ $symbol SSH ](fg:{{ .theme.colors.t1 }} bg:{{ .theme.tokens.palette.yellow.normal }})[](fg:{{ .theme.tokens.palette.yellow.normal }} bg:{{ $accent }})"
shell = ["sh"]
description = "Shows when connected via SSH"

# System Information

[cmd_duration]
format = "[⏱ $duration ]($style)"

[status]
disabled = false
pipestatus = true
format = "[$symbol$status]($style)"
symbol = "✘"
pipestatus_format = "\\[$pipestatus\\]($style)"

[directory]
read_only = " 󰌾"
truncation_length = 2
fish_style_pwd_dir_length = 1
use_logical_path = true
style = "fg:{{ $accent }} bg:{{ .theme.colors.t2 }}"
format = "[$path]($style)[$read_only]($style)"

[time]
disabled = false
style = "fg:prev_fg bg:prev_bg"
time_format = "%R"              # Hour:Minute Format
format = '[$time]($style)'

[custom.live-clock-icon]
command = 'echo "󱑖󱑋" | cut -c $(($(date +%H)%12+1))'
description = "Live updating clock icon, changes hourly. Icons can be customized to your liking."
when = true
style = "fg:prev_fg bg:prev_bg"
format = "[$output]($style)"

[battery]
display = [
  { discharging_symbol = "󰁺", style = "bg:prev_bg fg:red", threshold = 10 },
  { discharging_symbol = "󰁻", style = "bg:prev_bg fg:yellow", threshold = 20 },
  { discharging_symbol = "󰁼", style = "bg:prev_bg fg:yellow", threshold = 30 },
  { discharging_symbol = "󰁽", style = "bg:prev_bg fg:green", threshold = 40 },
  { discharging_symbol = "󰁾", style = "bg:prev_bg fg:green", threshold = 50 },
  { discharging_symbol = "󰁿", style = "bg:prev_bg fg:green", threshold = 60 },
  { discharging_symbol = "󰂀", style = "bg:prev_bg fg:green", threshold = 70 },
  { discharging_symbol = "󰂁", style = "bg:prev_bg fg:green", threshold = 80 },
  { discharging_symbol = "󰂂", style = "bg:prev_bg fg:green", threshold = 90 },
  { discharging_symbol = "󰁹", style = "bg:prev_bg fg:green", threshold = 100 },
]
full_symbol = "󱈑"
charging_symbol = "󰂄"
discharging_symbol = "󰁾"
unknown_symbol = "󰂑"
empty_symbol = "󰂃"
format = "[$symbol]($style)"

# Version Control

[git_branch]
symbol = ""
format = '$symbol $branch'
style = "fg:prev_fg bg:prev_bg"

[git_commit]
tag_symbol = " "
style = "fg:prev_fg bg:prev_bg"

[git_status]
format = "[$ahead_behind]($style)"
style = "fg:prev_fg bg:prev_bg"
stashed = "≡"
ahead = "${count}"
behind = "${count}"
diverged = "${behind_count}${ahead_count}"

[custom.git_status_dirty]
when = 'test -n "$(git status --porcelain 2>/dev/null)"'
symbol = "•"
style = "fg:prev_fg bg:prev_bg"
format = "[$symbol]($style)"
shell = ["sh"]

[hg_branch]
symbol = ""

[fossil_branch]
symbol = ""
format = "\\[[$symbol$branch]($style)\\]"

# Languages

[nodejs]
symbol = ""
format = '[$symbol ($version)]($style) '

[rust]
symbol = ""
format = '[$symbol ($version)]($style) '

[golang]
symbol = ""
format = '[$symbol ($version)]($style) '

[package]
disabled = false
symbol = "󰏗"
display_private = true
format = '[$symbol ($version)]($style) '

[python]
symbol = ""
format = "[${symbol} ${pyenv_prefix}(${version})(@$virtualenv)]($style)"

[php]
symbol = ""
format = '[$symbol ($version)]($style)'

[buf]
symbol = ""
format = '[$symbol ($version)]($style)'

[c]
symbol = ""
format = '[$symbol ($version)]($style)'

[cmake]
symbol = ""
format = '[$symbol ($version)]($style)'

[elixir]
symbol = ""
format = '[$symbol ($version)]($style)'

[java]
symbol = ""
format = '[$symbol ($version)]($style)'

[kotlin]
symbol = ""
format = '[$symbol ($version)]($style)'

[lua]
symbol = ""
format = '[$symbol ($version)]($style)'

[ruby]
symbol = ""
format = '[$symbol ($version)]($style)'

[zig]
symbol = ""
format = '[$symbol ($version)]($style)'

# Context

[aws]
disabled = false
symbol = ""
format = "[($symbol ($profile)@$region)(|$duration)]($style) "

[docker_context]
symbol = ""
disabled = false

[kubernetes]
disabled = true
symbol = ""
format = "[($symbol $context(|$namespace))]($style) "
